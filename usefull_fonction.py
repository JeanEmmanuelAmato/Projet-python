dico_tranche_age = {-0.95197:"18-24",
                    -0.07854:"25-34",
                    0.49788:"35-44",
                    1.09449:"45-54",
                    1.82213:"55-64",
                    2.59171:"65+"}

dico_nv_education = {-2.43591:"left school before 16",
                     -1.73790:"left school at 16",
                     -1.43719:"left school at 17",
                     -1.22751:"left school at 18",
                     -0.61113:"Some college or uni, no certif/degree",
                     -0.05921:"Professional certificate/ diploma",
                      0.45468:"Uni degree",
                      1.16365:"Masters degree",
                      1.98437:"Doctorate degree"}




dico_tranche_age_inv = {0:"18-24",
                        1:"25-34",
                        2:"35-44",
                        3:"45-54",
                        4:"55-64",
                        5:"65+"}

dico_nv_education_inv = {0:"left school before 16",
                         1:"left school at 16",
                         2:"left school at 17",
                         3:"left school at 18",
                         4:"Some college or uni, no certif/degree",
                         5:"Professional certificate/ diploma",
                         6:"Uni degree",
                         7:"Masters degree",
                         8:"Doctorate degree"}

dico_nscore = {0: -3.46436, 1: -3.15735, 2: -2.75696, 3: -2.52197, 4: -2.42317, 5: -2.3436, 6: -2.21844, 
               7: -2.05048, 8: -1.86962, 9: -1.69163, 10: -1.55078, 11: -1.43907, 12: -1.32828, 13: -1.1943, 
               14: -1.05308, 15: -0.92104, 16: -0.79151, 17: -0.67825, 18: -0.58016, 19: -0.46725, 20: -0.34799, 
               21: -0.24649, 22: -0.14882, 23: -0.05188, 24: 0.04257, 25: 0.13606, 26: 0.22393, 27: 0.31287, 
               28: 0.41667, 29: 0.52135, 30: 0.62967, 31: 0.73545, 32: 0.82562, 33: 0.91093, 34: 1.02119, 
               35: 1.13281, 36: 1.23461, 37: 1.37297, 38: 1.49158, 39: 1.60383, 40: 1.72012, 41: 1.8399, 
               42: 1.98437, 43: 2.127, 44: 2.28554, 45: 2.46262, 46: 2.61139, 47: 2.82196, 48: 3.27393} 

dico_escore = {0: -3.27393, 1: -3.00537, 2: -2.72827, 3: -2.5383, 4: -2.44904, 5: -2.32338, 6: -2.21069, 
               7: -2.11437, 8: -2.03972, 9: -1.92173, 10: -1.7625, 11: -1.6334, 12: -1.50796, 13: -1.37639, 
               14: -1.23177, 15: -1.09207, 16: -0.94779, 17: -0.80615, 18: -0.69509, 19: -0.57545, 20: -0.43999, 
               21: -0.30033, 22: -0.15487, 23: 0.00332, 24: 0.16767, 25: 0.32197, 26: 0.47617, 27: 0.63779, 
               28: 0.80523, 29: 0.96248, 30: 1.11406, 31: 1.2861, 32: 1.45421, 33: 1.58487, 34: 1.74091, 
               35: 1.93886, 36: 2.127, 37: 2.32338, 38: 2.57309, 39: 2.8595, 40: 3.00537, 41: 3.27393} 

dico_oscore = {0: -3.27393, 1: -2.8595, 2: -2.63199, 3: -2.39883, 4: -2.21069, 5: -2.09015, 6: -1.97495, 
               7: -1.82919, 8: -1.68062, 9: -1.55521, 10: -1.42424, 11: -1.27553, 12: -1.11902, 
               13: -0.97631, 14: -0.84732, 15: -0.71727, 16: -0.58331, 17: -0.45174, 18: -0.31776, 
               19: -0.17779, 20: -0.01928, 21: 0.14143, 22: 0.29338, 23: 0.44585, 24: 0.58331, 25: 0.7233, 
               26: 0.88309, 27: 1.06238, 28: 1.24033, 29: 1.43533, 30: 1.65653, 31: 1.88511, 32: 2.15324, 
               33: 2.44904, 34: 2.90161} 

dico_ascore = {0: -3.46436, 1: -3.15735, 2: -3.00537, 3: -2.90161, 4: -2.78793, 5: -2.70172, 6: -2.5383, 
               7: -2.35413, 8: -2.21844, 9: -2.07848, 10: -1.92595, 11: -1.772, 12: -1.6209, 13: -1.47955, 
               14: -1.34289, 15: -1.21213, 16: -1.07533, 17: -0.91699, 18: -0.76096, 19: -0.60633, 20: -0.45321, 
               21: -0.30172, 22: -0.15487, 23: -0.01729, 24: 0.13136, 25: 0.28783, 26: 0.43852, 27: 0.59042, 
               28: 0.76096, 29: 0.94156, 30: 1.11406, 31: 1.2861, 32: 1.45039, 33: 1.61108, 34: 1.81866, 
               35: 2.03972, 36: 2.23427, 37: 2.46262, 38: 2.75696, 39: 3.15735, 40: 3.46436} 

dico_cscore = {0: -3.46436, 1: -3.15735, 2: -2.90161, 3: -2.72827, 4: -2.57309, 5: -2.42317, 6: -2.30408, 
               7: -2.18109, 8: -2.04506, 9: -1.92173, 10: -1.78169, 11: -1.64101, 12: -1.5184, 13: -1.38502, 
               14: -1.25773, 15: -1.13788, 16: -1.0145, 17: -0.89891, 18: -0.78155, 19: -0.65253, 20: -0.52745, 
               21: -0.40581, 22: -0.27607, 23: -0.14277, 24: -0.00665, 25: 0.12331, 26: 0.25953, 27: 0.41594, 
               28: 0.58489, 29: 0.7583, 30: 0.93949, 31: 1.13407, 32: 1.30612, 33: 1.46191, 34: 1.63088, 
               35: 1.81175, 36: 2.04506, 37: 2.33337, 38: 2.63199, 39: 3.00537, 40: 3.46436} 

dico_impulsive = {0: -2.55524, 1: -1.37983, 2: -0.71126, 3: -0.21712, 4: 0.19268, 5: 0.52975, 
                  6: 0.88113, 7: 1.29221, 8: 1.86203, 9: 2.90161}

dico_SS = {0: -2.07848, 1: -1.54858, 2: -1.18084, 3: -0.84637, 4: -0.52593, 5: -0.21575, 
           6: 0.07987, 7: 0.40148, 8: 0.7654, 9: 1.2247, 10: 1.92173}

def datapreprocessing(df):
    X = df.copy()
    
    X.drop(["Pays"], axis = 1, inplace = True)
    X.drop(["Ethnie"], axis = 1, inplace = True)
    
    X["Genre"] = X["Genre"].map(lambda x: "Male" if x < 0 else "Female")
    X["Tranche_Age"] = X["Tranche_Age"].map(dico_tranche_age)
    X["Niveau_Education"] = X["Niveau_Education"].map(dico_nv_education)
    #X = pd.get_dummies(columns=["Tranche_Age", "Genre", "Niveau_Education"], data = X)
    
    return X

def miseEnForme(dict_message):
    dict_message["Tranche_Age"] = dico_tranche_age_inv[int(dict_message["Tranche_Age"])]
    dict_message["Niveau_Education"] = dico_nv_education_inv[int(dict_message["Niveau_Education"])]
    dict_message["Nscore"] = dico_nscore[int(dict_message["Nscore"])]
    dict_message["Escore"] = dico_escore[int(dict_message["Escore"])]
    dict_message["Oscore"] = dico_oscore[int(dict_message["Oscore"])]
    dict_message["Ascore"] = dico_ascore[int(dict_message["Ascore"])]
    dict_message["Cscore"] = dico_cscore[int(dict_message["Cscore"])]
    dict_message["Impulsive"] = dico_impulsive[int(dict_message["Impulsive"])]
    dict_message["SS"] = dico_SS[int(dict_message["SS"])]
    return dict_message
    